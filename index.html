<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Card Generator - Global University IDs</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- html2canvas & jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap"
        rel="stylesheet">

    <style>
        * {
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Professional Student Card */
        .student-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            aspect-ratio: 1.586/1;
        }

        .card-header-bar {
            height: 8px;
            background: linear-gradient(90deg, #FF6B6B 0%, #4ECDC4 25%, #45B7D1 50%, #FFA07A 75%, #98D8C8 100%);
        }

        .card-logo-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #e8ebf0 100%);
            padding: 1.5rem 1rem;
            border-bottom: 2px solid #e0e0e0;
        }

        .university-logo {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #fff;
        }

        .card-body {
            padding: 1.5rem 1.25rem;
            background: white;
        }

        .student-photo {
            width: 110px;
            height: 140px;
            border: 3px solid #e0e0e0;
            border-radius: 8px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .info-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            color: #666;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-bottom: 0.15rem;
        }

        .info-value {
            font-size: 0.9rem;
            color: #1a1a1a;
            font-weight: 600;
            line-height: 1.3;
        }

        .barcode-section {
            background: #f8f9fa;
            padding: 0.75rem;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            margin-top: 1rem;
        }

        .barcode {
            background: repeating-linear-gradient(90deg, #000 0px, #000 2px, #fff 2px, #fff 4px);
            height: 50px;
            border-radius: 4px;
        }

        .validity-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
        }

        .input-field {
            transition: all 0.3s ease;
        }

        .input-field:focus {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-country {
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-country:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .jp-text {
            font-family: 'Noto Sans JP', sans-serif;
        }

        .kr-text {
            font-family: 'Noto Sans KR', sans-serif;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }
    </style>
</head>

<body class="p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-6 fade-in">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-3">üéì Student Card Generator</h1>
            <p class="text-white text-lg opacity-90 mb-4">Generate realistic student ID cards from 12+ countries with AI
                photos</p>

            <!-- Country Buttons -->
            <div class="flex flex-wrap justify-center gap-2 mb-4">
                <button onclick="generateByCountry('india')"
                    class="btn-country bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm">üáÆüá≥
                    India</button>
                <button onclick="generateByCountry('us')"
                    class="btn-country bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm">üá∫üá∏
                    US</button>
                <button onclick="generateByCountry('uk')"
                    class="btn-country bg-blue-800 hover:bg-blue-900 text-white px-4 py-2 rounded-lg text-sm">üá¨üáß
                    UK</button>
                <button onclick="generateByCountry('canada')"
                    class="btn-country bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm">üá®üá¶
                    Canada</button>
                <button onclick="generateByCountry('australia')"
                    class="btn-country bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded-lg text-sm">üá¶üá∫
                    Australia</button>
                <button onclick="generateByCountry('germany')"
                    class="btn-country bg-gray-800 hover:bg-gray-900 text-white px-4 py-2 rounded-lg text-sm">üá©üá™
                    Germany</button>
                <button onclick="generateByCountry('france')"
                    class="btn-country bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">üá´üá∑
                    France</button>
                <button onclick="generateByCountry('korea')"
                    class="btn-country bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm">üá∞üá∑
                    Korea</button>
                <button onclick="generateByCountry('japan')"
                    class="btn-country bg-red-400 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm">üáØüáµ
                    Japan</button>
                <button onclick="generateByCountry('singapore')"
                    class="btn-country bg-red-700 hover:bg-red-800 text-white px-4 py-2 rounded-lg text-sm">üá∏üá¨
                    Singapore</button>
                <button onclick="generateByCountry('china')"
                    class="btn-country bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm">üá®üá≥
                    China</button>
                <button onclick="generateByCountry('brazil')"
                    class="btn-country bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm">üáßüá∑
                    Brazil</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Form Section -->
            <div class="glass-card rounded-2xl shadow-2xl p-6 md:p-8 fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìù Student Information</h2>

                <form class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="fullName"
                            class="input-field w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:outline-none"
                            placeholder="John Smith" maxlength="40">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Date of Birth</label>
                        <input type="date" id="dob"
                            class="input-field w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:outline-none">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Student ID</label>
                        <input type="text" id="studentId"
                            class="input-field w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:outline-none"
                            placeholder="STU123456" maxlength="20">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Department / Major</label>
                        <input type="text" id="department"
                            class="input-field w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:outline-none"
                            placeholder="Computer Science" maxlength="60">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Student Email (for copy
                            only)</label>
                        <div class="flex gap-2">
                            <input type="email" id="email"
                                class="input-field flex-1 px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:outline-none"
                                placeholder="student@university.edu">
                            <button type="button" onclick="copyEmail()"
                                class="bg-blue-500 hover:bg-blue-600 text-white px-4 rounded-lg">üìã</button>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Email won't be shown on the card</p>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Photo</label>
                        <button type="button" onclick="generateAIPhoto()"
                            class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-4 py-3 rounded-lg font-semibold mb-3">
                            üñºÔ∏è Generate AI Photo
                        </button>
                        <input type="file" id="photoUpload" accept="image/*" class="hidden">
                        <button type="button" onclick="document.getElementById('photoUpload').click()"
                            class="w-full border-2 border-dashed border-gray-300 hover:border-purple-500 rounded-lg p-4 text-gray-600 hover:text-purple-600">
                            üì§ Upload Custom Photo
                        </button>
                    </div>

                    <div class="flex gap-3">
                        <button type="button" onclick="downloadPNG()"
                            class="flex-1 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 py-4 rounded-lg text-white font-bold shadow-lg">
                            üì• PNG
                        </button>
                        <button type="button" onclick="downloadPDF()"
                            class="flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 py-4 rounded-lg text-white font-bold shadow-lg">
                            üìÑ PDF
                        </button>
                    </div>
                </form>
            </div>

            <!-- Card Preview -->
            <div class="fade-in">
                <div class="glass-card rounded-2xl shadow-2xl p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">üëÅÔ∏è Card Preview</h2>

                    <div id="studentCard" class="student-card">
                        <div class="card-header-bar"></div>

                        <div class="card-logo-section">
                            <div class="flex items-center justify-center gap-3">
                                <div class="university-logo">
                                    <svg class="w-12 h-12 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path
                                            d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z" />
                                    </svg>
                                </div>
                                <div class="text-center">
                                    <h3 class="font-bold text-gray-800 text-base leading-tight" id="universityName">ABC
                                        UNIVERSITY</h3>
                                    <p class="text-gray-600 text-xs mt-0.5" id="universityNameEn">School of Excellence
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="card-body">
                            <div class="flex gap-4">
                                <div class="student-photo flex items-center justify-center">
                                    <img id="cardPhoto" class="w-full h-full object-cover hidden" alt="Student">
                                    <svg id="cardPhotoPlaceholder" class="w-16 h-16 text-gray-400" fill="currentColor"
                                        viewBox="0 0 24 24">
                                        <path
                                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                    </svg>
                                </div>

                                <div class="flex-1 space-y-2.5">
                                    <div>
                                        <p class="info-label">NAME</p>
                                        <p id="cardName" class="info-value">---</p>
                                    </div>
                                    <div>
                                        <p class="info-label">DATE OF BIRTH</p>
                                        <p id="cardDob" class="info-value text-sm">---</p>
                                    </div>
                                    <div>
                                        <p class="info-label">STUDENT ID</p>
                                        <p id="cardId" class="info-value">---</p>
                                    </div>
                                    <div>
                                        <p class="info-label">DEPARTMENT</p>
                                        <p id="cardDept" class="info-value text-sm leading-tight">---</p>
                                    </div>
                                </div>
                            </div>

                            <div class="barcode-section">
                                <div class="barcode mb-2"></div>
                                <div class="flex items-center justify-between">
                                    <p class="text-xs font-mono font-semibold text-gray-700" id="cardBarcodeText">
                                        *STU123456*</p>
                                    <span class="validity-badge" id="cardExpiry">Valid: 12/2027</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                        <p class="text-sm text-blue-800">
                            <strong>Note:</strong> Click country button for random data or fill manually
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-white space-y-3">
            <div class="opacity-90">
                <a href="https://buymeacoffee.com/thanhnguyxn" target="_blank"
                    class="inline-flex items-center gap-2 bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-semibold px-6 py-3 rounded-lg shadow-lg transition-all hover:scale-105">
                    <span class="text-2xl">‚òï</span>
                    <span>Buy Me a Coffee</span>
                </a>
            </div>
            <p class="text-sm opacity-75">
                Made with ‚ù§Ô∏è for educational purposes ‚Ä¢
                <a href="https://github.com/ThanhNguyxn/student-card-generator" target="_blank"
                    class="underline hover:opacity-100">GitHub</a>
            </p>
        </div>
    </div>

    <script>
        const universities = {
            india: [
                { name: "Indian Institute of Technology Delhi", nameEn: "IIT Delhi", domain: "iitd.ac.in" },
                { name: "University of Mumbai", nameEn: "Mumbai University", domain: "mu.ac.in" },
                { name: "Delhi University", nameEn: "DU", domain: "du.ac.in" },
                { name: "Jawaharlal Nehru University", nameEn: "JNU", domain: "jnu.ac.in" },
                { name: "Banaras Hindu University", nameEn: "BHU", domain: "bhu.ac.in" }
            ],
            us: [
                { name: "Massachusetts Institute of Technology", nameEn: "MIT", domain: "mit.edu" },
                { name: "Stanford University", nameEn: "Stanford", domain: "stanford.edu" },
                { name: "Harvard University", nameEn: "Harvard", domain: "harvard.edu" },
                { name: "UC Berkeley", nameEn: "Berkeley", domain: "berkeley.edu" },
                { name: "Yale University", nameEn: "Yale", domain: "yale.edu" }
            ],
            uk: [
                { name: "University of Oxford", nameEn: "Oxford", domain: "ox.ac.uk" },
                { name: "University of Cambridge", nameEn: "Cambridge", domain: "cam.ac.uk" },
                { name: "Imperial College London", nameEn: "Imperial", domain: "imperial.ac.uk" },
                { name: "UCL", nameEn: "UCL", domain: "ucl.ac.uk" },
                { name: "University of Edinburgh", nameEn: "Edinburgh", domain: "ed.ac.uk" }
            ],
            canada: [
                { name: "University of Toronto", nameEn: "U of T", domain: "utoronto.ca" },
                { name: "UBC", nameEn: "UBC", domain: "ubc.ca" },
                { name: "McGill University", nameEn: "McGill", domain: "mcgill.ca" },
                { name: "University of Alberta", nameEn: "UAlberta", domain: "ualberta.ca" },
                { name: "University of Waterloo", nameEn: "Waterloo", domain: "uwaterloo.ca" }
            ],
            australia: [
                { name: "University of Melbourne", nameEn: "Melbourne", domain: "unimelb.edu.au" },
                { name: "University of Sydney", nameEn: "Sydney", domain: "sydney.edu.au" },
                { name: "ANU", nameEn: "ANU", domain: "anu.edu.au" },
                { name: "University of Queensland", nameEn: "UQ", domain: "uq.edu.au" },
                { name: "Monash University", nameEn: "Monash", domain: "monash.edu" }
            ],
            germany: [
                { name: "LMU M√ºnchen", nameEn: "LMU Munich", domain: "lmu.de" },
                { name: "TU M√ºnchen", nameEn: "TU Munich", domain: "tum.de" },
                { name: "Universit√§t Heidelberg", nameEn: "Heidelberg", domain: "uni-heidelberg.de" },
                { name: "Humboldt-Universit√§t", nameEn: "Humboldt Berlin", domain: "hu-berlin.de" },
                { name: "Freie Universit√§t Berlin", nameEn: "FU Berlin", domain: "fu-berlin.de" }
            ],
            france: [
                { name: "Universit√© PSL", nameEn: "PSL", domain: "psl.eu" },
                { name: "Sorbonne Universit√©", nameEn: "Sorbonne", domain: "sorbonne-universite.fr" },
                { name: "√âcole Polytechnique", nameEn: "Polytechnique", domain: "polytechnique.edu" },
                { name: "Sciences Po", nameEn: "Sciences Po", domain: "sciencespo.fr" },
                { name: "Universit√© Paris-Saclay", nameEn: "Paris-Saclay", domain: "universite-paris-saclay.fr" }
            ],
            korea: [
                { name: "ÏÑúÏö∏ÎåÄÌïôÍµê", nameEn: "Seoul National University", domain: "snu.ac.kr" },
                { name: "Ïó∞ÏÑ∏ÎåÄÌïôÍµê", nameEn: "Yonsei University", domain: "yonsei.ac.kr" },
                { name: "Í≥†Î†§ÎåÄÌïôÍµê", nameEn: "Korea University", domain: "korea.ac.kr" },
                { name: "ÌïúÏñëÎåÄÌïôÍµê", nameEn: "Hanyang University", domain: "hanyang.ac.kr" },
                { name: "ÏÑ±Í∑†Í¥ÄÎåÄÌïôÍµê", nameEn: "SKKU", domain: "skku.edu" }
            ],
            japan: [
                { name: "Êù±‰∫¨Â§ßÂ≠¶", nameEn: "University of Tokyo", domain: "u-tokyo.ac.jp" },
                { name: "‰∫¨ÈÉΩÂ§ßÂ≠¶", nameEn: "Kyoto University", domain: "kyoto-u.ac.jp" },
                { name: "Êó©Á®≤Áî∞Â§ßÂ≠¶", nameEn: "Waseda University", domain: "waseda.jp" },
                { name: "ÊÖ∂ÊáâÁæ©Â°æÂ§ßÂ≠¶", nameEn: "Keio University", domain: "keio.ac.jp" },
                { name: "Â§ßÈò™Â§ßÂ≠¶", nameEn: "Osaka University", domain: "osaka-u.ac.jp" }
            ],
            singapore: [
                { name: "NUS", nameEn: "NUS", domain: "nus.edu.sg" },
                { name: "NTU", nameEn: "NTU", domain: "ntu.edu.sg" },
                { name: "SMU", nameEn: "SMU", domain: "smu.edu.sg" },
                { name: "SUTD", nameEn: "SUTD", domain: "sutd.edu.sg" },
                { name: "SIT", nameEn: "SIT", domain: "singaporetech.edu.sg" }
            ],
            china: [
                { name: "Ê∏ÖÂçéÂ§ßÂ≠¶", nameEn: "Tsinghua University", domain: "tsinghua.edu.cn" },
                { name: "Âåó‰∫¨Â§ßÂ≠¶", nameEn: "Peking University", domain: "pku.edu.cn" },
                { name: "Â§çÊó¶Â§ßÂ≠¶", nameEn: "Fudan University", domain: "fudan.edu.cn" },
                { name: "‰∏äÊµ∑‰∫§ÈÄöÂ§ßÂ≠¶", nameEn: "Shanghai Jiao Tong", domain: "sjtu.edu.cn" },
                { name: "ÊµôÊ±üÂ§ßÂ≠¶", nameEn: "Zhejiang University", domain: "zju.edu.cn" }
            ],
            brazil: [
                { name: "USP", nameEn: "USP", domain: "usp.br" },
                { name: "UNICAMP", nameEn: "UNICAMP", domain: "unicamp.br" },
                { name: "UFRJ", nameEn: "UFRJ", domain: "ufrj.br" },
                { name: "UFMG", nameEn: "UFMG", domain: "ufmg.br" },
                { name: "PUC-Rio", nameEn: "PUC-Rio", domain: "puc-rio.br" }
            ]
        };

        const departments = {
            india: ["Computer Science", "Electrical Engineering", "Mechanical Engineering", "Business Admin", "Economics"],
            us: ["Computer Science", "Business Administration", "Psychology", "Biology", "Engineering"],
            uk: ["Computer Science", "Engineering", "Business Studies", "Law", "Medicine"],
            canada: ["Computer Science", "Engineering", "Business", "Health Sciences", "Arts"],
            australia: ["IT", "Engineering", "Business", "Medicine", "Arts"],
            germany: ["Informatik", "Maschinenbau", "BWL", "Medizin", "Jura"],
            france: ["Informatique", "Ing√©nierie", "Commerce", "M√©decine", "Droit"],
            korea: ["Ïª¥Ìì®ÌÑ∞Í≥µÌïô", "Í≤ΩÏòÅÌïô", "Ï†ÑÏûêÍ≥µÌïô", "ÏùòÌïô", "Î≤ïÌïô"],
            japan: ["ÊÉÖÂ†±Â∑•Â≠¶", "ÁµåÂñ∂Â≠¶", "ÈõªÊ∞óÈõªÂ≠êÂ∑•Â≠¶", "ÂåªÂ≠¶", "Ê≥ïÂ≠¶"],
            singapore: ["Computer Science", "Business", "Engineering", "IS", "Law"],
            china: ["ËÆ°ÁÆóÊú∫ÁßëÂ≠¶", "Â∑•ÂïÜÁÆ°ÁêÜ", "ÁîµÊ∞îÂ∑•Á®ã", "ÂåªÂ≠¶", "Ê≥ïÂ≠¶"],
            brazil: ["Ci√™ncia da Computa√ß√£o", "Engenharia", "Administra√ß√£o", "Medicina", "Direito"]
        };

        let currentCountry = null;
        let currentUniversity = null;

        const fullNameInput = document.getElementById('fullName');
        const dobInput = document.getElementById('dob');
        const studentIdInput = document.getElementById('studentId');
        const departmentInput = document.getElementById('department');
        const emailInput = document.getElementById('email');
        const photoUploadInput = document.getElementById('photoUpload');

        const cardName = document.getElementById('cardName');
        const cardDob = document.getElementById('cardDob');
        const cardId = document.getElementById('cardId');
        const cardDept = document.getElementById('cardDept');
        const cardPhoto = document.getElementById('cardPhoto');
        const cardPhotoPlaceholder = document.getElementById('cardPhotoPlaceholder');
        const universityName = document.getElementById('universityName');
        const universityNameEn = document.getElementById('universityNameEn');
        const cardExpiry = document.getElementById('cardExpiry');
        const cardBarcodeText = document.getElementById('cardBarcodeText');

        function generateDOB() {
            const year = Math.floor(Math.random() * 7) + 1998;
            const month = String(Math.floor(Math.random() * 12) + 1).padStart(2, '0');
            const day = String(Math.floor(Math.random() * 28) + 1).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function generateStudentId(university, year) {
            const prefix = university.nameEn.substring(0, 3).toUpperCase().replace(/\s/g, '');
            const randomNum = Math.floor(Math.random() * 9000) + 1000;
            return `${prefix}${year}${randomNum}`;
        }

        async function generateByCountry(country) {
            currentCountry = country;
            const universityList = universities[country];
            currentUniversity = universityList[Math.floor(Math.random() * universityList.length)];

            // Get random user data from API
            try {
                const response = await fetch(`https://randomuser.me/api/?nat=${country === 'india' ? 'in' : country === 'us' ? 'us' : country === 'uk' ? 'gb' : country === 'canada' ? 'ca' : country === 'australia' ? 'au' : country === 'germany' ? 'de' : country === 'france' ? 'fr' : country === 'brazil' ? 'br' : 'us'}`);
                const data = await response.json();
                const user = data.results[0];

                const name = `${user.name.first} ${user.name.last}`;
                const dob = generateDOB();
                const year = dob.substring(2, 4);
                const studentId = generateStudentId(currentUniversity, year);
                const department = departments[country][Math.floor(Math.random() * departments[country].length)];
                const email = `${user.login.username}@${currentUniversity.domain}`;

                fullNameInput.value = name;
                dobInput.value = dob;
                studentIdInput.value = studentId;
                departmentInput.value = department;
                emailInput.value = email;

                // Set photo
                cardPhoto.src = user.picture.large;
                cardPhoto.classList.remove('hidden');
                cardPhotoPlaceholder.classList.add('hidden');

                updateCard();
                updateUniversity();

                const expiryYear = parseInt(dob.substring(0, 4)) + 22;
                cardExpiry.textContent = `Valid: 12/${expiryYear}`;
            } catch (error) {
                console.error('Error fetching data:', error);
                alert('Error generating data. Please try again.');
            }
        }

        function updateCard() {
            cardName.textContent = fullNameInput.value || '---';
            cardDob.textContent = dobInput.value ? new Date(dobInput.value).toLocaleDateString('en-GB') : '---';
            cardId.textContent = studentIdInput.value || '---';
            cardDept.textContent = departmentInput.value || '---';
            cardBarcodeText.textContent = studentIdInput.value ? `*${studentIdInput.value}*` : '*STU123456*';

            if (currentCountry === 'japan') {
                cardName.className = 'info-value jp-text';
                cardDept.className = 'info-value text-sm leading-tight jp-text';
            } else if (currentCountry === 'korea') {
                cardName.className = 'info-value kr-text';
                cardDept.className = 'info-value text-sm leading-tight kr-text';
            } else {
                cardName.className = 'info-value';
                cardDept.className = 'info-value text-sm leading-tight';
            }
        }

        function updateUniversity() {
            if (!currentUniversity) return;

            universityName.textContent = currentUniversity.name;
            universityNameEn.textContent = currentUniversity.nameEn;

            if (currentCountry === 'japan') {
                universityName.className = 'font-bold text-gray-800 text-base leading-tight jp-text';
            } else if (currentCountry === 'korea') {
                universityName.className = 'font-bold text-gray-800 text-base leading-tight kr-text';
            } else {
                universityName.className = 'font-bold text-gray-800 text-base leading-tight';
            }
        }

        async function generateAIPhoto() {
            try {
                const response = await fetch('https://randomuser.me/api/');
                const data = await response.json();
                const photoUrl = data.results[0].picture.large;

                cardPhoto.src = photoUrl;
                cardPhoto.classList.remove('hidden');
                cardPhotoPlaceholder.classList.add('hidden');
            } catch (error) {
                console.error('Error generating photo:', error);
                alert('Error generating photo. Please try again.');
            }
        }

        function copyEmail() {
            const email = emailInput.value;
            if (email) {
                navigator.clipboard.writeText(email).then(() => {
                    alert('Email copied to clipboard!');
                });
            }
        }

        photoUploadInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    cardPhoto.src = event.target.result;
                    cardPhoto.classList.remove('hidden');
                    cardPhotoPlaceholder.classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        });

        fullNameInput.addEventListener('input', updateCard);
        dobInput.addEventListener('input', () => {
            updateCard();
            if (dobInput.value) {
                const year = parseInt(dobInput.value.substring(0, 4)) + 22;
                cardExpiry.textContent = `Valid: 12/${year}`;
            }
        });
        studentIdInput.addEventListener('input', updateCard);
        departmentInput.addEventListener('input', updateCard);

        async function downloadPNG() {
            try {
                const canvas = await html2canvas(document.getElementById('studentCard'), {
                    scale: 3,
                    backgroundColor: '#ffffff',
                    useCORS: true
                });

                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.download = `student-card-${studentIdInput.value || 'card'}.png`;
                    link.href = url;
                    link.click();
                    URL.revokeObjectURL(url);
                });
            } catch (error) {
                console.error('Error:', error);
                alert('Error generating PNG');
            }
        }

        async function downloadPDF() {
            try {
                const canvas = await html2canvas(document.getElementById('studentCard'), {
                    scale: 3,
                    backgroundColor: '#ffffff',
                    useCORS: true
                });

                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'mm',
                    format: [85.6, 53.98]
                });

                pdf.addImage(imgData, 'PNG', 0, 0, 85.6, 53.98);
                pdf.save(`student-card-${studentIdInput.value || 'card'}.pdf`);
            } catch (error) {
                console.error('Error:', error);
                alert('Error generating PDF');
            }
        }
    </script>
</body>

</html>